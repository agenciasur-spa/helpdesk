---
import Layout from "../../layouts/Layout.astro";
import Navbar from "../../components/layout/Navbar.astro";
import Footer from "../../components/layout/Footer.astro";
import data from "../../content/helpdesk-data.json";
import CallToAction from "../../components/ui/CallToAction.astro";
import FeaturedArticles from "../../components/ui/FeaturedArticles.astro";

import CallContact from "../../components/ui/CallContact.astro";

import Hero from "../../components/ui/Hero.astro";
import Card from "../../components/ui/Card.astro";
const { home } = data;

export async function getStaticPaths() {
  const { categories, articles } = data;

  return categories.map((category) => ({
    params: { slug: category.slug },
    props: {
      category,
      articles: articles.filter((a) => a.categorySlug === category.slug),
    },
  }));
}

const { category, articles } = Astro.props;

const featuredarticles = articles.slice(0, 4);
const otherarticles = articles.slice(4, 8);
---

<Layout>
  <Navbar />
  <main>
    <div class="container py-5">
      <Hero title={category.title} subtitle={category.longdescription} />

      <div class="row g-4">
        {
          featuredarticles.map((article) => (
            <Card
              title={article.title}
              text={category.description}
              btnUrl={`/helpdesk/articles/${article.slug}/`}
              key={article.slug}
            />
          ))
        }
      </div>

      <div class="row g-4 d-flex mt-4">
        {
          otherarticles.map((article) => (
            <div class="col">
              <a
                href={`/helpdesk/articles/${article.slug}/`}
                class="w-100 btn btn-outline-primary"
              >
                {article.title}
              </a>
            </div>
          ))
        }
      </div>
    </div>

    <CallToAction
      title={""}
      text={"¿No esta la categoría que buscas? ingresa una consulta en la mesa telefónica"}
      btnUrl={""}
      btnText={"Llamar al 84400"}
      btnIco={"1"}
    />

    <FeaturedArticles articles={articles} />

    <div class="container py-5">
      <CallContact
        title={home.callcontact.title}
        text={home.callcontact.text}
        btnUrl={home.callcontact.btnUrl}
        btnText={home.callcontact.btnText}
        btnIco={home.callcontact.btnIco}
      />
    </div>

    <div class="mt-4">
      <a href="/" class="btn btn-outline-secondary">← Volver al inicio</a>
    </div>
  </main>
  <Footer />
</Layout>
